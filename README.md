–ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫:

–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∏–∑ aiogram –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ë–æ—Ç, –î–∏—Å–ø–µ—Ç—á–µ—Ä, –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, —Ç–∏–ø—ã

logging: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. requests: –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤. aiogram: –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram Bot API.

–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:

TOKEN_API = '7741709346:AAHkFecrqeooCrBwlhEyxUJufI7d9kH3KHM' –ö–õ–Æ–ß_–ü–û–ì–û–î–û–í–û–ì–û_API = '1f86be97bad23fc8703e21181e0d64af'

API_TOKEN: —Ç–æ–∫–µ–Ω –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –±–æ—Ç–∞ –≤ Telegram. WEATHER_API_KEY: –∫–ª—é—á API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–≥–æ–¥–µ –æ—Ç OpenWeatherMap.

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

–≤–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞.basicConfig(—É—Ä–æ–≤–µ–Ω—å = –≤–µ–¥–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞.–ò–ù–§–û–†–ú–ê–¶–ò–Ø)

–≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è INFO –∏ –≤—ã—à–µ.

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞ –∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞:

bot = –ë–æ—Ç (—Ç–æ–∫–µ–Ω = API_TOKEN) dp = –î–∏—Å–ø–µ—Ç—á–µ—Ä (–±–æ—Ç)

–°–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç Bot —Å —Ç–æ–∫–µ–Ω–æ–º. –î–∏—Å–ø–µ—Ç—á–µ—Ä —É–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥ /start –∏ /help:

@dp.message_handler(–∫–æ–º–∞–Ω–¥—ã=['start', 'help']) async def send_welcome(—Å–æ–æ–±—â–µ–Ω–∏–µ: —Ç–∏–ø—ã.Message): """ –≠—Ç–æ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏—Ç –∫–æ–º–∞–Ω–¥—É /start –∏–ª–∏ /help """ await message.reply("–ü—Ä–∏–≤–µ—Ç!\n–Ø EchoBot!\n–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ aiogram.")

–≠—Ç–æ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–≤–µ—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º, –∫–æ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–æ–º–∞–Ω–¥—ã /start –∏–ª–∏ /help.

–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /weather:

@dp.message_handler(–∫–æ–º–∞–Ω–¥—ã=['–ø–æ–≥–æ–¥–∞']) async def send_weather(—Å–æ–æ–±—â–µ–Ω–∏–µ: —Ç–∏–ø—ã.Message): –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–≥–æ–¥–µ = get_weather_samara() await message.answer(–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–≥–æ–¥–µ)

–≠—Ç–æ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é get_weather_samara() –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–≥–æ–¥–µ.

–§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–≥–æ–¥—ã:

def get_weather_samara(): –≥–æ—Ä–æ–¥ = ¬´–°–∞–º–∞—Ä–∞¬ª url = f"http://api.openweathermap.org/data/2.5/weather?q={–≥–æ—Ä–æ–¥}&appid={–ö–õ–Æ–ß_–ü–û–ì–û–î–û–í–û–ì–û_API}&units=metric&lang=ru" response = requests.get(url)

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è city —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –≥–æ—Ä–æ–¥–∞. –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è URL –¥–ª—è HTTP-–∑–∞–ø—Ä–æ—Å–∞ –∫ API –ø–æ–≥–æ–¥—ã.

–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ API:

if response.status_code == 200: data = response.json() temp = data['main']['temp'] feels_like = data['main']['feels_like'] weather_desc = data['weather'][0]['description'].capitalize() humidity = data['main']['humidity'] wind_speed = data['wind']['speed'] city_name = data['name'] country = data['sys']['country'] return ( f"üå§ –ü–æ–≥–æ–¥–∞ –≤ {city_name}, {country}:\n" f"–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {temp}¬∞C (–æ—â—É—â–∞–µ—Ç—Å—è –∫–∞–∫ {feels_like}¬∞C)\n" f"–û–ø–∏—Å–∞–Ω–∏–µ: {weather_desc}\n" f"–í–ª–∞–∂–Ω–æ—Å—Ç—å: {humidity}%\n" f"–°–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞: {wind_speed} –º/—Å" )

–ï—Å–ª–∏ –æ—Ç–≤–µ—Ç —É—Å–ø–µ—à–Ω—ã–π (–∫–æ–¥ 200), –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ JSON-–æ—Ç–≤–µ—Ç–∞. –ò–∑–≤–ª–µ–∫–∞—é—Ç—Å—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–≥–æ–¥—ã: —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –æ–ø–∏—Å–∞–Ω–∏–µ, –≤–ª–∞–∂–Ω–æ—Å—Ç—å, —Å–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞ –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞.

–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏:

–≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ: –≤–µ—Ä–Ω–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ¬´‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ¬ª.

–ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.

–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞:

if name == 'main': executor.start_polling(dp, skip_updates=True) –≠—Ç–æ—Ç –±–ª–æ–∫ –∫–æ–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—è –≤—Ö–æ–¥—è—â–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è. skip_updates=True –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã –≤ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–º —Ä–µ–∂–∏–º–µ.
